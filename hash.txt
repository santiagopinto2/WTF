unsigned char* buf = malloc(SHA_DIGEST_LENGTH);
bzero(buf, sizeof(buf));
char* new_hash = malloc(SHA_DIGEST_LENGTH*2);
SHA1(message, strlen(message), buf);
for (i = 0; i < SHA_DIGEST_LENGTH; i++)
	sprintf((char*)&(new_hash[i*2]), "%02x", buf[i]);
new_hash[strlen(new_hash)-1] = '\0';
